---
layout: post
title: å¯¹æ¯”PgSQLå’ŒMySQLå­¦ä¹ äº‹åŠ¡çš„éš”ç¦»çº§åˆ«
date: 2018-05-30 18:06
header-img: "img/head.jpg"
categories: jekyll update
tags:
    - PostgreSQL
	- MySQL
typora-root-url: ../../yummyliu.github.io
---

{:toc}

# SQL92ä¸å¹¶å‘å¼‚å¸¸

ANSI SQLÂ ä¸ºäº†é¢„é˜²ä¸‰ç§ä¸åŒçš„å¹¶å‘å¼‚å¸¸ç°è±¡ï¼Œå®šä¹‰äº†å››ä¸ªéš”ç¦»çº§åˆ«ã€‚æœ€ä¸¥æ ¼çš„æ˜¯Serializableï¼Œå³ï¼Œä»»ä½•ä¸€ä¸ªSerializableäº‹åŠ¡çš„å¹¶å‘æ‰§è¡Œéƒ½èƒ½ä¿è¯äº§ç”Ÿå’Œ**æŒ‰æŸä¸€é¡ºåºä¸²è¡Œ**åœ°æ‰§è¡Œå®ƒä»¬ç›¸åŒçš„æ•ˆæœã€‚ç”±äºSerializableçš„å®šä¹‰ï¼Œåœ¨è¿™ä¸ªçº§åˆ«ä¸Šè¿™äº›ç°è±¡éƒ½æ˜¯ä¸å¯èƒ½çš„ï¼ˆè¿™å¹¶ä¸å¥‡æ€ªï¼šå¦‚æœæ•ˆæœå¿…é¡»ä¸ä¸€æ¬¡è¿è¡Œä¸€è‡´ï¼Œé‚£ä¹ˆæ‚¨æ€ä¹ˆçœ‹åˆ°äº¤äº’é€ æˆçš„ç°è±¡ï¼Ÿï¼‰ã€‚å¦å¤–ä¸‰ä¸ªçº§åˆ«æ˜¯æ ¹æ®å¼‚å¸¸ç°è±¡æ¥å®šä¹‰çš„ï¼Œå¦‚ä¸‹ã€‚

| éš”ç¦»çº§åˆ«        | è„è¯»            | ä¸å¯é‡å¤è¯»   | å¹»è¯»            | ä¸²è¡ŒåŒ–å¼‚å¸¸   |
| --------------- | --------------- | ------------ | --------------- | ------------ |
| Read Uncommited | Possible(NO PG) | Possible     | Possible        | Possible     |
| Read Commited   | Not Possible    | Possible     | Possible        | Possible     |
| Repeatable Read | Not Possible    | Not Possible | Possible(NO PG) | Possible     |
| Serializable    | Not Possible    | Not Possible | Not Possible    | Not Possible |

> NO PG
>
> PgSQLä¸­ï¼Œéƒ¨åˆ†éš”ç¦»çº§åˆ«å®ç°çš„æ¯”è¾ƒä¸¥æ ¼ã€‚

## RCé¿å… è„è¯»

è„è¯»ä¾‹å­ï¼šäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼›

| T1                                | T2                             |
| --------------------------------- | ------------------------------ |
| select a from t where b=3;        |                                |
|                                   | update t set a = 5 where b =3; |
| select a from t where b=3;(a = 5) |                                |
|                                   | Rollback;                      |

## RRé¿å… ä¸å¯é‡å¤è¯»

äº‹åŠ¡é‡æ–°è¯»å–ä¹‹å‰è¯»è¿‡çš„æ•°æ®æ—¶ï¼Œå‘ç°è¯¥æ•°æ®è¢«å¦ä¸€ä¸ª**æäº¤çš„äº‹åŠ¡update**äº†ï¼›è„è¯»å’Œä¸å¯é‡å¤å¾ˆåƒï¼ŒåŒºåˆ«åœ¨äºè„è¯»åœ¨T2è¿˜æœªæäº¤æ—¶ï¼Œå°±è¯»äº†ã€‚

ä¸å¯é‡å¤è¯»ä¾‹å­ï¼š

| T1                                | T2                             |
| --------------------------------- | ------------------------------ |
| select a from t where b=3;        |                                |
|                                   | update t set a = 5 where b =3; |
|                                   | commit;                        |
| select a from t where b=3;(a = 5) |                                |

åœ¨åŸºäºlockçš„å¹¶å‘æ§åˆ¶ä¸­ï¼Œt1åœ¨è¯»å–äº‹åŠ¡æ—¶æ²¡æœ‰è·å–è¯»é”æˆ–è€…ç¬¬ä¸€ä¸ªselectåï¼Œç«‹é©¬å°±é‡Šæ”¾äº†è¯»é”ï¼›ä¼šå¯¼è‡´t2è¯»å–åˆ°æ›´æ–°å·²ç»è¯»è¿‡çš„ä½†æ²¡æäº¤çš„æ•°æ®ã€‚è§£å†³æ–¹æ³•å°±æ˜¯åœ¨RRçº§åˆ«ä¸­ï¼Œé€šè¿‡é”ï¼Œä½¿t1/t2è¿›è¡Œä¸²è¡ŒåŒ–è°ƒåº¦ã€‚

åœ¨åŸºäºmvccçš„å¹¶å‘æ§åˆ¶ä¸­ï¼Œå½“t2å‘ç”Ÿ**æäº¤å†²çª**æ—¶ï¼Œå¤„ç†ç­–ç•¥ä¸å¤Ÿä¸¥æ ¼ä¹Ÿä¼šå¯¼è‡´ä¸å¯é‡å¤è¯»ã€‚è§£å†³æ–¹æ³•å°±æ˜¯åœ¨RRçº§åˆ«ä¸­ï¼Œé€šè¿‡åªè¯»å–äº‹åŠ¡å¼€å§‹æ—¶ç‰ˆæœ¬çš„æ•°æ®ï¼Œä¿è¯åœ¨æ•´ä¸ªäº‹åŠ¡ç”Ÿå‘½å‘¨æœŸå†…æ•°æ®æ˜¯ä¸€è‡´çš„ï¼Œè¿™ä¹Ÿæ˜¯PostgreSQLå’ŒMySQLéƒ½é‡‡ç”¨çš„å®ç°æ–¹å¼ã€‚

> æäº¤å†²çªï¼ˆcommit conflictï¼‰:
>
> ä¸ºäº†é¿å…ä¸Šè¿°åŸºäºé”çš„å¹¶å‘æ§åˆ¶ä¸­ï¼Œt1/t2è¦ä¸²è¡ŒåŒ–æ‰èƒ½è§£å†³é—®é¢˜ï¼Œmvccé€šè¿‡å¤šç‰ˆæœ¬æ•°æ®ï¼Œå…è®¸t2å…ˆæäº¤ï¼Œè¿™æ ·è¯»å†™ä¸é˜»å¡ï¼›
>
> + å¦‚æœ**åœ¨SERIALIZABLEçº§åˆ«ä¸­**ï¼Œç”±äºè¯»çš„æ•°æ®æ˜¯**äº‹åŠ¡**å¼€å§‹æ—¶çš„å¿«ç…§ï¼Œ**t1åªæœ‰è¯»**ä¸ä¼šå‡ºç°é—®é¢˜ï¼›å¦‚æœt1ä¹Ÿå¯¹æ•°æ®è¿›è¡Œäº†å˜æ›´ï¼Œé‚£ä¹ˆæäº¤çš„æ—¶å€™ï¼Œdbä¼šæ£€æŸ¥t1æäº¤çš„ç»“æœå’ŒæŒ‰ç…§t1/t2ï¼ˆå³ï¼Œä»¥äº‹åŠ¡å¼€å§‹æ—¶é—´ç®—ï¼‰é¡ºåºçš„ä¸²è¡Œç»“æœæ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´å¯æäº¤ï¼Œå¦åˆ™å°±æ˜¯**æäº¤å†²çª**ï¼›æ­¤æ—¶ï¼Œt1éœ€è¦å›æ»šï¼ˆè¿™å°±å‘ç”Ÿäº†åºåˆ—åŒ–é”™è¯¯ï¼‰ã€‚
> + æˆ–è€…**åœ¨RCä¸­**ï¼Œç”±äºè¯»çš„æ•°æ®æ˜¯**æŸ¥è¯¢**å¼€å§‹æ—¶çš„å¿«ç…§ï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰ä¸²è¡ŒåŒ–ä¿è¯ï¼Œä¹Ÿä¸ä¼šæœ‰æäº¤å†²çªã€‚

## Sé¿å… å¹»è¯»

ç”±äºå¦ä¸€ä¸ªäº‹åŠ¡**Insert**äº†ä¸€æ¡æ–°æ•°æ®ï¼Œå¯¼è‡´è¿™ä¸ªæ—§äº‹åŠ¡çš„æŸäº›æŸ¥è¯¢ç»“æœå˜äº†ï¼Œæ¯”å¦‚count(*)ã€‚

| T1                                                     | T2                              |
| ------------------------------------------------------ | ------------------------------- |
| select * from t where b >0 and b <5; ï¼ˆå‡è®¾æœ‰2æ¡æ•°æ®ï¼‰ |                                 |
|                                                        | insert into t(a,b) values(1,3); |
|                                                        | commit;                         |
| select * from t where b >0 and b <5; (å¤šäº†ä¸€æ¡)        |                                 |

åœ¨åŸºäºé”çš„å¹¶å‘æ§åˆ¶ä¸­ï¼Œé‡‡ç”¨RRï¼Œæ„å‘³ç€ä¼šå°†è¯»å‡ºçš„æ•°æ®è¡ŒåŠ é”ã€‚ä½†æ˜¯ä¸ä¼šåœ¨è¡¨çš„æŸä¸€èŒƒå›´ï¼ˆæ¯”å¦‚ä¾‹å­ä¸­åªä¼šå¯¹2æ¡æ•°æ®åŠ é”ï¼‰åŠ é”ï¼Œè¿™æ ·åˆ«çš„äº‹åŠ¡ä¼šåœ¨è¯¥èŒƒå›´å†…æ’å…¥ä¸€æ¡æ•°æ®ï¼›åé¢åŒæ ·çš„æŸ¥è¯¢å°±ä¼šå¤šå‡ºä¸€æ¡æ¥ã€‚

## å…¶ä»–å¼‚å¸¸

ä»¥ä¸Šçš„SQLéš”ç¦»çº§åˆ«æ ‡å‡†å¹¶æ²¡æœ‰åšåˆ°å®ç°æ— å…³ï¼ŒåŸºæœ¬å°±æ˜¯åŸºäºLockçš„å¹¶å‘æ§åˆ¶ä¸­çš„éš”ç¦»çº§åˆ«ã€‚åœ¨è®ºæ–‡Generalized Isolation Level Definitionsä¸­ï¼ŒåŸºäºäº‹åŠ¡ä¹‹é—´çš„è¯»å†™ä¾èµ–ï¼Œæå‡ºäº†æ–°çš„**å®ç°æ— å…³çš„éš”ç¦»çº§åˆ«**ï¼Œå¦‚ä¸‹ã€‚

![img](/image/ansi-sql-isolation-levels.png)

å¦å¤–ï¼Œç”±äºå¤§éƒ¨åˆ†æ•°æ®åº“å®ç°äº†MVCCçš„å¹¶å‘æ§åˆ¶ï¼Œå› æ­¤ä¹Ÿäº§ç”Ÿäº†Lockæœºåˆ¶ä¸‹æ²¡æœ‰çš„å¹¶å‘å¼‚å¸¸ï¼Œå¦‚ä¸‹ä¸‰ç§ï¼š

### Lost Update ï¼ˆ**ww-conflict**ï¼‰

T1ã€T2å¯¹åŒä¸€è¡¨çš„åŒä¸€è¡Œçš„åŒä¸€åˆ—è¿›è¡Œæ›´æ–°ï¼›ä¸€ä¸ªå°†å¦ä¸€ä¸ªçš„æ›´æ–°è¦†ç›–ã€‚

| T1                                     | T2                                     |
| -------------------------------------- | -------------------------------------- |
| beginï¼›                                |                                        |
|                                        | beginï¼›                                |
| update t set val = 10 where key = 'a'; | select * from t where key = 'a';       |
| Commit;                                | update t set val = 40 where key = 'a'; |
|                                        | Commit;                                |

T1çš„æ›´æ–°è¢«è¦†ç›–äº†ã€‚

### Read Skew

T1éœ€è¦ç»Ÿè®¡a/bä¸¤ä¸ªè´¦ç›®çš„æ€»å€¼ï¼›åŸæ¥a=50,b=50ï¼Œa/bæœŸé—´ä¼šè¿›è¡Œè½¬è´¦;

| T1                                       | T2(aè½¬ç»™b 25)                           |
| ---------------------------------------- | --------------------------------------- |
| Begin;                                   |                                         |
| select val from t where name = 'a'; (50) |                                         |
|                                          | Begin;                                  |
|                                          | update t set val = 25 where name = 'a'; |
|                                          | update t set val = 75 where name = 'b'; |
|                                          | commit;                                 |
| select val from t where name = 'b'; (75) |                                         |
| Commit;                                  |                                         |

æœ€åT1å‘ç°æ€»å€¼ä¸º125ï¼Œå¤šäº†25ï¼Œè¿™å°±æ˜¯Read Skewã€‚

### Write Skew

T1è¯»å–Aå€¼ï¼Œèµ‹å€¼ç»™Bï¼›T2è¯»å–Bå€¼ï¼Œèµ‹å€¼ç»™Aï¼›å¦‚æœä¸²è¡Œæ‰§è¡Œï¼Œä¸ç®¡è°å…ˆè°åï¼Œæœ€åçš„ç»“æœéƒ½æ˜¯A=Bï¼›ç„¶è€Œï¼ŒåŸºäºMVCCçš„RRçº§åˆ«ï¼Œå¯èƒ½å‡ºç°å¦‚ä¸‹å¼‚å¸¸ï¼Œå¯¼è‡´åªæ˜¯å°†aå’Œbç½®æ¢äº†ï¼Œè¿™å°±æ˜¯write skewï¼š

| T1                                      | T2                                      |
| --------------------------------------- | --------------------------------------- |
| Begin;                                  |                                         |
|                                         | Begin;                                  |
| select val from t where name = 'a';(10) |                                         |
|                                         | select val from t where name = 'b';(20) |
| update t set val = 10 where name = 'b'; |                                         |
|                                         | update t set val = 20 where name = 'a'; |
| commit;                                 |                                         |
|                                         | commit;                                 |
| b = 10                                  | a = 20;                                 |

---------------------------

å¹¶å‘æ§åˆ¶çš„å®ç°ä¸­ï¼ŒPostgreSQLå’ŒMySQLéƒ½åŒæ—¶é‡‡ç”¨äº†lockå’ŒMVCCçš„æ–¹å¼ï¼Œå› æ­¤åœ¨å…·ä½“è¡¨ç°ä¸Šä¹Ÿæœ‰æ‰€åŒºåˆ«ï¼Œè¿™é‡Œå¯¹ä¸¤ä¸ªæ•°æ®åº“è¿›è¡Œå¯¹æ¯”äº†è§£ï¼Œå¦‚ä¸‹ã€‚

# å¯¹æ¯”å­¦ä¹ MySQLä¸PgSQLçš„éš”ç¦»çº§åˆ«å®ç°

è¿™é‡Œåªè®¨è®ºSQLæ ‡å‡†ä¸­çš„éš”ç¦»çº§åˆ«ã€‚è¿™é‡Œå°±ä¸è®¨è®ºè¯»æœªæäº¤ï¼Œè§‰å¾—æ²¡æœ‰æ²¡æœ‰æ„ä¹‰ï¼ˆæ²¡æƒ³åˆ°ä»€ä¹ˆåœºæ™¯ï¼Œæœ‰äººä¼šåˆ»æ„è¯»æœªæäº¤çš„æ•°æ®ï¼‰ã€‚PostgreSQLé»˜è®¤æ˜¯RCçº§åˆ«ï¼ŒMySQLé»˜è®¤æ˜¯RRçº§åˆ«ï¼›å®ç°æ–¹å¼ç±»ä¼¼ä¹Ÿæœ‰å·®åˆ«ã€‚

## RCï¼ˆRead Commitï¼‰

åœ¨PGä¸­ï¼Œå¼€å¯ä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯·æ±‚ä¸Šè¿°å››ç§éš”ç¦»çº§åˆ«(SERIALIZABLE,REPEATABLE READ, READ COMMITTED , READ UNCOMMITTED); ä½†æ˜¯RUè¿™ä¸ªçº§åˆ«ï¼Œå…¶å®å°±æ˜¯RCã€‚

> **NOTE**ï¼šåœ¨PGé‡Œä¸€äº›æ•°æ®ç±»å‹å’Œå‡½æ•°æœ‰ç‰¹æ®Šçš„äº‹åŠ¡è¡Œä¸ºï¼Œç‰¹åˆ«åœ°ï¼Œå¯¹ä¸€ä¸ªsequenceçš„ä¿®æ”¹ï¼Œå…¶ä»–äº‹åŠ¡é‡Œé¢å¯è§ï¼Œå½“å‰äº‹åŠ¡æ„å¤–ç»ˆæ­¢ï¼Œä¹Ÿä¸ä¼šå›æ»šã€‚

åœ¨RCçº§åˆ«ä¸­ï¼ŒPostgreSQLå’ŒMySQLéƒ½æ˜¯åŸºäºMVCCçš„æ–¹å¼è¿›è¡Œè¯»å†™åˆ†ç¦»ï¼š

åœ¨æ‰§è¡ŒæŸæ¡**è¯­å¥**çš„æ—¶å€™ï¼Œè·å–å½“å‰å¯è§çš„æ•°æ®ç‰ˆæœ¬ï¼ŒPostgreSQLå«Snapshotï¼ŒMySQLå«readviewã€‚è¯¥ç‰ˆæœ¬çš„æ•°æ®ä¿è¯éƒ½æ˜¯å·²ç»æäº¤çš„æ•°æ®ï¼Œå› æ­¤ä¸ä¼šå‡ºç°è„è¯»ï¼Œæ»¡è¶³RCçš„è¦æ±‚ã€‚

## RRï¼ˆRepeat Readï¼‰

å’ŒRCç›¸åŒï¼ŒPostgreSQLå’ŒMySQLè¿˜æ˜¯é‡‡ç”¨MVCCçš„æ–¹å¼å®ç°ï¼›ä½†æ˜¯è¿™é‡ŒPostgreSQLå’ŒMySQLéƒ½æ˜¯å–äº‹åŠ¡ä¸€å¼€å§‹çš„æ•°æ®ç‰ˆæœ¬ï¼›ç”±äºåœ¨æ•´ä¸ªäº‹åŠ¡ä¸­éƒ½æ˜¯ä½¿ç”¨ä¸€ä¸ªæ•°æ®ç‰ˆæœ¬ï¼Œå› æ­¤å¯¹äºè¯»å‡ºçš„æ•°æ®å¯ä»¥å®ç°**é‡å¤è¯»**ï¼Œæ»¡è¶³RRçº§åˆ«ã€‚

å¦å¤–ï¼Œåœ¨RRçº§åˆ«ä¸­ï¼ŒPostgreSQLå’ŒMySQLéƒ½æ¯”SQLæ ‡å‡†æ›´åŠ ä¸¥æ ¼ï¼Œä¸ä¼šå‡ºç°å¹»è¯»ã€‚ä½†æ˜¯ï¼Œåœ¨MySQLçš„é»˜è®¤éš”ç¦»çº§åˆ«RRä¸‹æ²¡æœ‰å¹»è¯»ï¼Œå´æœ‰**å¹»å†™**ï¼Œå¦‚ä¸‹ä¸¤ä¾‹ï¼š

+ æ›´æ–°äº†ä¸€ä¸ªreadviewä¸­çš„æ—§è¡Œ

```sql
--- T1 begin
mysql> start transaction;
mysql> select * from t;
+-----+--------+------+---------+------+
| a   | b      | c    | d       | e    |
+-----+--------+------+---------+------+
...
| 394 | asdf | asdf | asdf    |  399 |
| 395 | asdf | asdf | asdf    |  400 |
| 397 | asdf | asdf | asdfasd |  402 |
+-----+------+------+---------+------+
Query OK, 0 rows affected (0.00 sec)
mysql> select * from t where a = 396;
Empty set (0.00 sec)

--- T2 begin
update t set a = 396 where e = 402;
--- T2 end

mysql> update t set b = 'pwrite' where a = 396;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0
mysql> select * from t where a = 396;
+-----+--------+------+---------+------+
| a   | b      | c    | d       | e    |
+-----+--------+------+---------+------+
| 396 | pwrite | asdf | asdfasd |  402 |
+-----+--------+------+---------+------+
1 row in set (0.00 sec)

mysql> commit;
Query OK, 0 rows affected (0.01 sec)
--- T1 end
```

+ æ’å…¥äº†ä¸€ä¸ªæ–°è¡Œï¼ˆå³ï¼Œä¸åœ¨readviewçš„æ–°è¡Œï¼‰

```sql
--- T1 begin
mysql> select * from t;
...
| 395 | asdf       | asdf | asdf    |  400 |
| 396 | pwrite     | asdf | asdfasd |  402 |
| 397 | new insert | asdf | s       |  403 |
| 398 | new insert | s    | s       |  404 |
+-----+------------+------+---------+------+
399 rows in set (0.01 sec)
--- T2 begin
mysql> insert into t(d) values (405);
--- T2 end
mysql> update t set e=405 where a = 399;
Query OK, 0 rows affected (0.00 sec)
Rows matched: 1  Changed: 0  Warnings: 0

mysql> commit;
Query OK, 0 rows affected (0.00 sec)
```

æˆ‘ä»¬å‘ç°T1å±…ç„¶å¯ä»¥æ›´æ–°äº†ä¸€ä¸ªæ²¡æœ‰è§è¿‡çš„rowï¼Œè¿™æ˜¯ä»€ä¹ˆæ“ä½œğŸ˜¹ï¼ŸåŸå› æ˜¯MySQLçš„readviewåªå¯¹éé”å®šè¯»æœ‰æ•ˆï¼Œå¯¹äºäº‹åŠ¡ä¸­update/deleteç­‰æ“ä½œéƒ½æ˜¯åŸºäºæœ€æ–°commitçš„æ•°æ®æ“ä½œï¼ˆè¿™ä¹ˆçœ‹MySQLèµ·çš„åâ€”â€”**è¯»è§†å›¾**ä¹Ÿæ²¡é”™ï¼Œä½†æ˜¯è¡Œä¸ºæœ‰ç‚¹å¥‡æ€ªï¼‰ã€‚

å› æ­¤ï¼Œå¯¹äºMySQLçš„RRçº§åˆ«ï¼Œæœ‰å¦‚ä¸‹ç»“è®ºï¼š

1. å½“åªæ˜¯selectè¯­å¥æ—¶ï¼Œæ˜¯æ²¡æœ‰å¹»è¯»ï¼ˆPhantom Readï¼‰çš„ï¼›æ¯”å¦‚mysqldump with â€“single-transactionã€‚

2. å½“äº‹åŠ¡ä¿®æ”¹æ•°æ®äº†ï¼ŒRRçº§åˆ«çš„è¡¨ç°æ˜¯æœ‰æ‰€ä¸åŒï¼›å¯¹äºæ²¡æœ‰ä¿®æ”¹çš„è¡Œï¼Œæ˜¯RRï¼›å¯¹äºä¿®æ”¹çš„è¡Œï¼Œæ˜¯RCã€‚å› ä¸ºï¼ŒSQLæ ‡å‡†ä¸­å¯¹æ­¤æ²¡æœ‰å®šä¹‰ï¼Œé‚£ä¹ˆä¹Ÿä¸èƒ½è¯´è¿åäº†SQLè¯­ä¹‰ã€‚

   > InnoDB provides REPEATABLE READ for read-only SELECT, but it behaves as if you use READ COMMITTED for all write queries

3. å½“äº‹åŠ¡å†™äº†æ–°æ•°æ®æ—¶ï¼Œè¯¥äº‹åŠ¡å°±ä½¿ç”¨å·²ç»æäº¤çš„æ•°æ®ï¼Œè€Œä¸æ˜¯è¯¥äº‹åŠ¡çš„readviewï¼›æ‰€ä»¥ï¼ŒInnoDBçš„äº‹åŠ¡ä¿®æ”¹æ€»æ˜¯åŸºäºæœ€æ–°çš„æäº¤çš„æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚

## Sï¼ˆSerializableï¼‰

MySQLåœ¨Sçº§åˆ«ä¸­ï¼Œæ”¾å¼ƒä½¿ç”¨MVCCçš„æœºåˆ¶ï¼Œé‡‡ç”¨Strict-2PLè¿›è¡Œå¹¶å‘æ§åˆ¶ï¼›è€ŒPostgreSQLè¿˜æ˜¯é‡‡ç”¨MVCCçš„æœºåˆ¶ï¼Œé€šè¿‡å¼•å…¥SI-Read lockçš„æ–¹å¼ï¼Œæ£€æŸ¥è¯»å†™ä¾èµ–ï¼Œé¿å…write-skewï¼Œå®ç°SSIï¼ˆåºåˆ—åŒ–å¿«ç…§éš”ç¦»ï¼Œæœºåˆ¶æ¯”è¾ƒå¤æ‚è§å¦ä¸€ä¸ªæ–‡ç« ï¼‰ã€‚

# å‚è€ƒæ–‡çŒ®

[wiki](https://en.wikipedia.org/wiki/Isolation_(database_systems)#Dirty_reads)

[ A Critique of ANSI SQL Isolation Levels](https://arxiv.org/pdf/cs/0701157.pdf)

